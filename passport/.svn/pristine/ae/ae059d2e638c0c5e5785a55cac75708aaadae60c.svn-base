package stargate;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.IntegrationTest;
import org.springframework.boot.test.SpringApplicationConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.MvcResult;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import cn.easywed.stargate.Application;

/**
 * Created by fu on 3/2/17.
 */

@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = Application.class)
@WebAppConfiguration
@IntegrationTest("server.port:0")
public class AppControlerTest {

	@Autowired
	private WebApplicationContext wac;

	private MockMvc mockMvc;

	@Before
	public void setup() throws Exception {
		mockMvc = MockMvcBuilders.webAppContextSetup(wac).build();
	}

	// @Test
	// public void testGetCode() throws Exception {
	// MvcResult result = mockMvc.perform(post("/register")
	// .param("username", "fusaa")
	// .param("password", "123456")
	// .param("mobile", "11555555531")
	// .param("departId", "1").param("roles", "1,2"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }

	// @Test
	// public void update() throws Exception {
	// MvcResult result = mockMvc.perform(post("/updateUser")
	// .param("userId", "60191")
	// .param("username", "fusaa22")
	// .param("password", "123456")
	// .param("mobile", "12555555531")
	// .param("departId", "1").param("roles", "1,2,3"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }

	 @Test
	 public void testLog() throws Exception {
	 MvcResult result = mockMvc.perform(post("/login")
	 .param("mobile", "18600889227")
	 .param("password", "123456"))
	 .andExpect(status().isOk())
	 .andReturn();
	 String json = result.getResponse().getContentAsString();
	 System.out.println(json);
	 }
	 
	 @Test
	 public void testticket() throws Exception {
	 MvcResult result = mockMvc.perform(post("/checkTicket")
	 .param("ticket", "sKapEpa/cq8FcMLORGXLnw=="))
	 .andExpect(status().isOk())
	 .andReturn();
	 String json = result.getResponse().getContentAsString();
	 System.out.println(json);
	 }

	 
	// @Test
	// public void testAuth() throws Exception {
	// MvcResult result = mockMvc.perform(post("/getUserAuth")
	// .param("roles", "1,2,3"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }
	//

	// @Test
	// public void testgetRole() throws Exception {
	// MvcResult result = mockMvc.perform(post("/getRole")
	// .param("roleId", "1"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }
	//

	// @Test
	// public void testgetAuth() throws Exception {
	// MvcResult result = mockMvc.perform(post("/getAuth")
	// .param("authId", "1"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }

	// @Test
	// public void getdepartment() throws Exception {
	// MvcResult result = mockMvc.perform(post("/getDepartment"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }
	//

	// @Test
	// public void testupdate() throws Exception {
	// MvcResult result = mockMvc.perform(post("/updateUser")
	// .param("userId", "10")
	// .param("username", "test")
	// .param("mobile", "15555555531")
	// .param("departId", "5"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }

	// @Test
	// public void getbaseinfo() throws Exception {
	// MvcResult result = mockMvc.perform(post("/getBaseInfo"))
	// .andExpect(status().isOk())
	// .andReturn();
	// String json = result.getResponse().getContentAsString();
	// System.out.println(json);
	// }

//	 @Test
//	 public void testgetUser() throws Exception {
//	 MvcResult result = mockMvc.perform(post("/getUsers").param("pageNo", "1").param("pageSize", "10"))
//	 .andExpect(status().isOk())
//	 .andReturn();
//	 String json = result.getResponse().getContentAsString();
//	 System.out.println(json);
//	 }


//	 @Test
//	 public void getUserInfobyUid() throws Exception {
//	 MvcResult result = mockMvc.perform(post("/getUserInfobyUid")
//	 .param("uid", "30560"))
//	 .andExpect(status().isOk())
//	 .andReturn();
//	 String json = result.getResponse().getContentAsString();
//	 System.out.println(json);
//	 }
	
//	 @Test
//	 public void getAuthsbyUid() throws Exception {
//	 MvcResult result = mockMvc.perform(post("/getAuthsbyUid")
//	 .param("uid", "30560"))
//	 .andExpect(status().isOk())
//	 .andReturn();
//	 String json = result.getResponse().getContentAsString();
//	 System.out.println(json);
//	 }
	
	
//	 
//	 @Test
//	 public void getUserInfobyUid() throws Exception {
//	 MvcResult result = mockMvc.perform(post("/getUserListbyRole")
//	 .param("roleId", "1"))
//	 .andExpect(status().isOk())
//	 .andReturn();
//	 String json = result.getResponse().getContentAsString();
//	 System.out.println(json);
//	 }
	 
	 
//	 //获取下属
//	 @Test 
//	 public void getFirstSub() throws Exception {
//	 MvcResult result = mockMvc.perform(post("/getFirstSub")
//	 .param("uid", "14799"))
//	 .andExpect(status().isOk())
//	 .andReturn();
//	 String json = result.getResponse().getContentAsString();
//	 System.out.println(json);
//	 }
	 
//	 //获取上司
//	 @Test 
//	 public void getSuperior() throws Exception {
//	 MvcResult result = mockMvc.perform(post("/getSuperior")
//	 .param("uid", "28074"))
//	 .andExpect(status().isOk())
//	 .andReturn();
//	 String json = result.getResponse().getContentAsString();
//	 System.out.println(json);
//	 }
	 

}
